$ErrorActionPreference = "SilentlyContinue"
$VerbosePreference = "continue"

$uninstalls = @("Search App by Ask", "Shopping App by Ask", "Avery Toolbar", "Google Toolbar for Internet Explorer", "Avery Teoma Search App", "Ask Toolbar", "eiPower Saver Agent")
$computer = Read-Host -Prompt 'Input computer name'
$list = (Get-ADComputer -Filter {Name -like $computer}).Name
Write-Verbose  -Message "Trying to query $($list.count) computers found in AD"

foreach ($computername in $list)  
{
    foreach ($element in $uninstalls)
    {
        (Get-WmiObject -ComputerName $computername -Class win32_product | where {$_.name -like $element}).uninstall()
            if ($? -eq $true)
            {
                Write-Verbose -Message "Uninstalled $element on $computername"
            }

            else
            {
                Write-Verbose -Message "Had an issue with $computername. $element wasnt found."
            }
    }
}
